---
title: "Climate Water Loss Experiment - Capture Analysis"
author: "Savannah Weaver"
date: "2022"
output: 
  rmdformats::html_clean:
    highlight: tango
    thumbnails: FALSE
    toc: TRUE
    toc_depth: 3
---


# Packages

```{r setup, include = TRUE, message = FALSE}
if (!require("tidyverse")) install.packages("tidyverse")
library("tidyverse") # workflow and plots
if (!require("lme4")) install.packages("lme4")
library("lme4") # for LMMs
if (!require("lmerTest")) install.packages("lmerTest")
library("lmerTest") # for p-values
if (!require("UsingR")) install.packages("UsingR")
library("UsingR") # simple.eda model assumption checker
if (!require("ggpubr")) install.packages("ggpubr")
library("ggpubr") # for multi-ggplot figs
if (!require("broom.mixed")) install.packages("broom.mixed")
library("broom.mixed") # lmer model export
if (!require("AICcmodavg")) install.packages("AICcmodavg")
library("AICcmodavg") # model selection
if (!require("car")) install.packages("car")
library("car") # VIFs
if (!require("RColorBrewer")) install.packages("RColorBrewer")
library("RColorBrewer") # color
if (!require("rmdformats")) install.packages("rmdformats")
library("rmdformats") # clean html R markdown format
```


# Background and Goals

This data was collected June - August by Master's student Savannah Weaver, advisor Dr. Emily Taylor, and research assistants Tess McIntyre and Taylor Van Rossum. Adult male *Sceloporus occidentalis* were caught across the Cal Poly campus then acclimated to 4 different climate treatments. This R file analyzes the state and variation of hydric physiology at the time of capture.


# Load Data

```{r}
dat <- read_rds("./data/analysis_data_capture.RDS")
summary(dat)
mean(dat$hold_time_hr, na.rm=T)
```


**note** IDs I do not have data for (and shouldn't): 254, 284, 304


## Check Weather ~ Date Distribution

```{r}
dat %>%
  group_by(capture_date) %>%
  summarise(min(VPD_kPa_int, na.rm = T),
            max(VPD_kPa_int, na.rm = T),
            min(wind_mph_interpol, na.rm = T),
            max(wind_mph_interpol, na.rm = T),
            min(temp_C_interpol, na.rm = T),
            max(temp_C_interpol, na.rm = T),
            min(solar_rad_W_sqm_interpol, na.rm = T),
            max(solar_rad_W_sqm_interpol, na.rm = T))
```


Temp, wind speed, and VPD were all exceptionally higher for the June 16 capture date compared to the other capture dates. We could either relativize the data, or remove the data for that date. Since I want the models to have intuitive results, I will remove the data for that capture date since it would skew our results.


## Clean Data

```{r}
dat_reduced <- dat %>%
  dplyr::filter(capture_date != as.Date("2021-06-16"))
summary(dat_reduced)
```



# LMMs

## By Date

Check whether our dependent or weather-predictor variables of interest are significantly different across capture dates.

```{r}
anova(lm(data = dat_reduced, 
           hematocrit_percent ~ as.factor(capture_date)))
anova(lm(data = dat_reduced, 
           osmolality_mmol_kg_mean ~ as.factor(capture_date)))
anova(lm(data = dat_reduced, 
           CEWL_g_m2h_mean ~ as.factor(capture_date)))
anova(lm(data = dat_reduced, 
           temp_C_interpol ~ as.factor(capture_date)))
anova(lm(data = dat_reduced, 
           VPD_kPa_int ~ as.factor(capture_date)))
anova(lm(data = dat_reduced, 
           wind_mph_interpol ~ as.factor(capture_date)))
anova(lm(data = dat_reduced, 
           solar_rad_W_sqm_interpol ~ as.factor(capture_date)))
```


Our variables of interest are still significantly different across capture dates, for hct, osml, and CEWL. So, we can include capture date as a random effect. Weather is significantly different across date for 3/4 of the variables, which is to be expected because the dates were spaced out across the season. We are primarily interested in within-day variability, and the ranges of the variables were similar across dates (after June 16 was removed), so this should not be an issue for what we're interested in.


## Hematocrit


### Models

First, start with a full model, then check for multicollinearity. 

```{r hct model 1}
hct_mod1 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size options
                          mass_g + SVL_mm + SMI +
                          # weather at the time of capture
                          temp_C_interpol * VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
hct_mod1_VIFs <- data.frame(VIF = car::vif(hct_mod1)) %>%
  arrange(desc(VIF))
hct_mod1_VIFs
```

remove VPD*temp interaction:

```{r hct model 2}
hct_mod2 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          mass_g + SVL_mm + SMI +
                          # weather at the time of capture
                          temp_C_interpol + VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
hct_mod2_VIFs <- data.frame(VIF = car::vif(hct_mod2)) %>%
  arrange(desc(VIF))
hct_mod2_VIFs
```


drop mass

```{r hct model 3}
hct_mod3 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SVL_mm + SMI +
                          # weather at the time of capture
                          temp_C_interpol + VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
hct_mod3_VIFs <- data.frame(VIF = car::vif(hct_mod3)) %>%
  arrange(desc(VIF))
hct_mod3_VIFs
```


drop temperature:

```{r hct model 4}
hct_mod4 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SVL_mm + SMI +
                          # weather at the time of capture
                          VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
hct_mod4_VIFs <- data.frame(VIF = car::vif(hct_mod4)) %>%
  arrange(desc(VIF))
hct_mod4_VIFs
drop1(hct_mod4)
```

VIFs are all below 5 now, so start backwards selection.

Drop SVL first:

```{r hct model 5}
hct_mod5 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SMI +
                          # weather at the time of capture
                          VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
drop1(hct_mod5)
```


Drop VPD:

```{r hct model 6}
hct_mod6 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SMI +
                          # weather at the time of capture
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
drop1(hct_mod6)
```

Drop solar:

```{r hct model 7}
hct_mod7 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SMI +
                          # weather at the time of capture
                          wind_mph_interpol)
drop1(hct_mod7)
```

Drop SMI:

```{r hct model 8}
hct_mod8 <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # weather at the time of capture
                          wind_mph_interpol)
```


Finally, null model:

```{r hct null model}
hct_mod_null <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 1)
```


### Selection

Compare models 4-8 and the null model.

```{r hct mod compare}
hct_models <- list(hct_mod4, hct_mod5, hct_mod6, hct_mod7, 
                   hct_mod8, hct_mod_null)

#specify model names
hct_mod_names <- c('(model 4) ~ Wind-C, SMI, Solar-C, VPD-C, SVL', 
                       '(model 5) ~ Wind-C, SMI, Solar-C, VPD-C', 
                       '(model 6) ~ Wind-C, SMI, Solar-C',
                       '(model 7) ~ Wind-C, SMI', 
                       '(model 8) ~ Wind-C', 
                       'null model')
#calculate AIC of each model
hct_AICc <- data.frame(aictab(cand.set = hct_models, 
                                 modnames = hct_mod_names))
hct_AICc
```


The best model is 7 with wind and SMI as predictors. Model 6 with Wind, SMI, and solar is equally as good.


### LM Conditions

Check that the best model meets the criteria for linear regression and has no collinearity.

```{r hct model assumptions}
vif(hct_mod7)
plot(hct_mod7)
simple.eda(residuals(hct_mod7))
shapiro.test(residuals(hct_mod7))
```

LINE is almost perfect.


### Export

```{r}
hct_mod7p <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SMI +
                          # weather at the time of capture
                          wind_mph_interpol)
hct_mod6p <- lm(data = dat_reduced,
                          # response variable
                          hematocrit_percent ~ 
                          # body size
                          SMI +
                          # weather at the time of capture
                          wind_mph_interpol + solar_rad_W_sqm_interpol)
anova(hct_mod7p)
anova(hct_mod6p)
```


## Osmolality


### Models

Since there are large differences in osmolality by date, but we are interested in what's different within dates, rather than the capture date itself, we will include that as a random effect in the model.

First, start with a full model with each predictor in it, then check for multicollinearity.

```{r osmolality model 1}
osml_mod1 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm + SMI +
                          # blood sample traits
                          hematocrit_percent + 
                          # weather at the time of capture
                          temp_C_interpol * VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          (1|capture_date))
osml_mod1_VIFs <- data.frame(VIF = car::vif(osml_mod1)) %>%
  arrange(desc(VIF))
osml_mod1_VIFs
```

VPD and temperature introduce a lot of collinearity, so start by dropping their interaction:

```{r osmolality model 2}
osml_mod2 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm + SMI +
                          # blood sample traits
                          hematocrit_percent + 
                          # weather at the time of capture
                          temp_C_interpol + VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          (1|capture_date))
osml_mod2_VIFs <- data.frame(VIF = car::vif(osml_mod2)) %>%
  arrange(desc(VIF))
osml_mod2_VIFs
drop1(osml_mod2)
anova(osml_mod2)
```

Drop SMI next, since it's extremely collinear with mass and SVL but explains less variance.

```{r osmolality model 3}
osml_mod3 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm +
                          # blood sample traits
                          hematocrit_percent + 
                          # weather at the time of capture
                          temp_C_interpol + VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          (1|capture_date))
osml_mod3_VIFs <- data.frame(VIF = car::vif(osml_mod3)) %>%
  arrange(desc(VIF))
osml_mod3_VIFs
drop1(osml_mod3)
anova(osml_mod3)
```

Temperature is still introducing a lot of multicollinearity with VPD, but temp has a much higher SS than VPD, so drop VPD:

```{r osmolality model 4}
osml_mod4 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm +
                          # blood sample traits
                          hematocrit_percent + 
                          # weather at the time of capture
                          temp_C_interpol +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          (1|capture_date))
osml_mod4_VIFs <- data.frame(VIF = car::vif(osml_mod4)) %>%
  arrange(desc(VIF))
osml_mod4_VIFs
anova(osml_mod4)
drop1(osml_mod4)
```


Great, VIFs are well-within acceptable ranges. Now we can start backwards model selection.

Start by dropping wind:

```{r osmolality model 5}
osml_mod5 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm +
                          # blood sample traits
                          hematocrit_percent + 
                          # weather at the time of capture
                          temp_C_interpol +
                          solar_rad_W_sqm_interpol +
                          (1|capture_date))
drop1(osml_mod5)
anova(osml_mod5)
```

Drop hematocrit:

```{r osmolality model 6}
osml_mod6 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm +
                          # weather at the time of capture
                          temp_C_interpol +
                          solar_rad_W_sqm_interpol +
                          (1|capture_date))
drop1(osml_mod6)
anova(osml_mod6)
```

Drop solar:

```{r osmolality model 7}
osml_mod7 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm +
                          # weather at the time of capture
                          temp_C_interpol +
                          (1|capture_date))
anova(osml_mod7)
```

Drop SVL:

```{r osmolality model 8}
osml_mod8 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g +
                          # weather at the time of capture
                          temp_C_interpol +
                          (1|capture_date))
anova(osml_mod8)
```

Drop mass:

```{r osmolality model 9}
osml_mod9 <- lme4::lmer(data = dat_reduced,
                          osmolality_mmol_kg_mean ~ 
                          temp_C_interpol +
                          (1|capture_date))
```

Lastly, compute null model:

```{r osmolality null model}
osml_mod_null <- lme4::lmer(data = dat_reduced,
                          osmolality_mmol_kg_mean ~ 1 +
                          (1|capture_date))
```


### Selection

Compare models 4-9 and null. 

```{r osml mod compare}
osml_models <- list(osml_mod4, osml_mod5, osml_mod6,
                    osml_mod7, osml_mod8, osml_mod9,
                    osml_mod_null)
#specify model names
osml_mod_names <- c('(model 4) ~ Temp-C, Mass, SVL, Solar-C, Hct, Wind-C', 
                       '(model 5) ~ Temp-C, Mass, SVL, Solar-C, Hct', 
                       '(model 6) ~ Temp-C, Mass, SVL, Solar-C',
                       '(model 7) ~ Temp-C, Mass, SVL', 
                       '(model 8) ~ Temp-C, Mass', 
                       '(model 9) ~ Temp-C', 
                       'null model')
#calculate AIC of each model
osml_AICc <- data.frame(aictab(cand.set = osml_models, 
                                 modnames = osml_mod_names))
osml_AICc
```

Temperature, mass, and SVL are the variables in the top 2 models.


### LM Conditions

Check residual plots and VIFs

```{r osml model assumptions}
vif(osml_mod8)
plot(osml_mod8)
simple.eda(residuals(osml_mod8))
shapiro.test(residuals(osml_mod8))
vif(osml_mod7)
plot(osml_mod7)
simple.eda(residuals(osml_mod7))
shapiro.test(residuals(osml_mod7))
```

There is no clear pattern in the residuals ~ fitted plot, so linearity seems satisfied. slight fanning, but equal error variance seems fine. Normality seems fine, even though the Shapiro-Wilk normality test is significant. VIFs essentially negligible.


### Export

re-run for p-values:

```{r osmolality best models}
osml_mod7p <- lmerTest::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g + SVL_mm +
                          # weather at the time of capture
                          temp_C_interpol + 
                          (1|capture_date))
summary(osml_mod7p)
osml_mod8p <- lmerTest::lmer(data = dat_reduced,
                          # response variable
                          osmolality_mmol_kg_mean ~ 
                          # body size
                          mass_g +
                          # weather at the time of capture
                          temp_C_interpol + 
                          (1|capture_date))
summary(osml_mod8p)
```



## CEWL

There are differences in CEWL across dates, and based on cloacal temp, capture temp, capture VPD, capture wind, and capture solar radiation.


### Models

Start with the full model of all potential predictor variables. We will again include date as a random effect.

Again, start with checking for multicollinearity.

```{r CEWL model 1}
CEWL_mod1 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # essential covariate
                          cloacal_temp_C +
                          # body size
                          mass_g + SVL_mm + SMI +
                          # blood
                          osmolality_mmol_kg_mean + hematocrit_percent + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          temp_C_interpol * VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr + 
                          (1|capture_date))
CEWL_mod1_VIFs <- data.frame(VIF = car::vif(CEWL_mod1)) %>%
  arrange(desc(VIF))
CEWL_mod1_VIFs
drop1(CEWL_mod1)
```


Just as for osmolality, VPD and temperature introduce a lot of collinearity. Start with dropping their interaction:

```{r CEWL model 2}
CEWL_mod2 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # essential covariate
                          cloacal_temp_C +
                          # body size
                          mass_g + SVL_mm + SMI +
                          # blood
                          osmolality_mmol_kg_mean + hematocrit_percent + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          temp_C_interpol + VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
CEWL_mod2_VIFs <- data.frame(VIF = car::vif(CEWL_mod2)) %>%
  arrange(desc(VIF))
CEWL_mod2_VIFs
drop1(CEWL_mod2)
anova(CEWL_mod2)
```

MUCH better. Drop SVL next:

```{r CEWL model 3}
CEWL_mod3 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # essential covariate
                          cloacal_temp_C +
                          # body size
                          mass_g + SMI +
                          # blood
                          osmolality_mmol_kg_mean + hematocrit_percent + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          temp_C_interpol + VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
CEWL_mod3_VIFs <- data.frame(VIF = car::vif(CEWL_mod3)) %>%
  arrange(desc(VIF))
CEWL_mod3_VIFs
drop1(CEWL_mod3)
anova(CEWL_mod3)
```


Next drop temperature at the time of capture:

```{r CEWL model 4}
CEWL_mod4 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # essential covariate
                          cloacal_temp_C +
                          # body size
                          mass_g + SMI +
                          # blood
                          osmolality_mmol_kg_mean + hematocrit_percent + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
CEWL_mod4_VIFs <- data.frame(VIF = car::vif(CEWL_mod4)) %>%
  arrange(desc(VIF))
CEWL_mod4_VIFs
drop1(CEWL_mod4)
anova(CEWL_mod4)
```


Drop hct:

```{r CEWL model 5}
CEWL_mod5 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # essential covariate
                          cloacal_temp_C +
                          # body size
                          mass_g + SMI +
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod5)
anova(CEWL_mod5)
```


next drop cloacal temperature:

```{r CEWL model 6}
CEWL_mod6 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # body size
                          mass_g + SMI +
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod6)
anova(CEWL_mod6)
```


next drop SMI:

```{r CEWL model 7}
CEWL_mod7 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # body size
                          mass_g + 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          VPD_kPa_int +
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod7)
anova(CEWL_mod7)
```


next drop VPD at capture:

```{r CEWL model 8}
CEWL_mod8 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # body size
                          mass_g + 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod8)
anova(CEWL_mod8)
```


#### 9
next drop mass:

```{r CEWL model 9}
CEWL_mod9 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod9)
anova(CEWL_mod9)
```

#### 10
next drop wind:

```{r CEWL model 10}
CEWL_mod10 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod10)
anova(CEWL_mod10)
```

drop VPD at msmt

```{r CEWL model 11}
CEWL_mod11 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C +
                          # weather at the time of capture
                          solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod11)
anova(CEWL_mod11)
```

drop solar:

#### 12

```{r CEWL model 12}
dat_reduced2 <- dat_reduced %>%
  dplyr::filter(complete.cases(osmolality_mmol_kg_mean, msmt_temp_C, hold_time_hr))
CEWL_mod12 <- lme4::lmer(data = dat_reduced2,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
drop1(CEWL_mod12)
anova(CEWL_mod12)
```

drop hold time:

```{r CEWL model 13}
CEWL_mod13 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C +
                          (1|capture_date))
drop1(CEWL_mod13)
anova(CEWL_mod13)
```


drop osml:

```{r CEWL model 14}
CEWL_mod14 <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # microclimate at the time of msmt
                          msmt_temp_C +
                          (1|capture_date))
```

And finally, null model:

```{r CEWL model null}
CEWL_mod_null <- lme4::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 1 +
                          (1|capture_date))
```



### Selection

compare models 4-14 and the null

```{r CEWL mod compare}
CEWL_models <- list(CEWL_mod4, CEWL_mod5, CEWL_mod6, CEWL_mod7, 
                    CEWL_mod8, CEWL_mod9, CEWL_mod10, CEWL_mod11,
                    CEWL_mod12, CEWL_mod13, CEWL_mod14, CEWL_mod_null)

#specify model names
CEWL_mod_names <- c('(model 4) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M, Wind-C, Mass, VPD-C, SMI, Clo-Temp, Hct', 
                    '(model 5) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M, Wind-C, Mass, VPD-C, SMI, Clo-Temp', 
                    '(model 6) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M, Wind-C, Mass, VPD-C, SMI', 
                       '(model 7) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M, Wind-C, Mass, VPD-C', 
                       '(model 8) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M, Wind-C, Mass',
                       '(model 9) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M, Wind-C', 
                       '(model 10) ~ Temp-M, Osml, Hold Time, Solar-C, VPD-M', 
                       '(model 11) ~ Temp-M, Osml, Hold Time, Solar-C',
                      '(model 12) ~ Temp-M, Osml, Hold Time',
                      '(model 13) ~ Temp-M, Osml',
                    '(model 14) ~ Temp-M',
                      'null model')
#calculate AIC of each model
CEWL_AICc <- data.frame(aictab(cand.set = CEWL_models, 
                                 modnames = CEWL_mod_names))
CEWL_AICc
```


The best models are 10, 9, then 12.



### LM Conditions

Check that the best model meets the criteria for linear regression and has no collinearity.

```{r CEWL model assumptions}
vif(CEWL_mod12)
plot(CEWL_mod12)
simple.eda(residuals(CEWL_mod12))
shapiro.test(residuals(CEWL_mod12))
vif(CEWL_mod10)
plot(CEWL_mod10)
simple.eda(residuals(CEWL_mod10))
shapiro.test(residuals(CEWL_mod10))
```

There is some slight fanning in the residuals ~ fitted plot, suggesting equal error variance is not perfect, but overall, all LNE conditions appear to be met and VIFs are very low.


### Export

Re-run the best model using lmerTest for p-values.

```{r CEWL best model p vals}
CEWL_mod10p <- lmerTest::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
summary(CEWL_mod10p)

CEWL_mod9p <- lmerTest::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C + msmt_VPD_kPa +
                          # weather at the time of capture
                          wind_mph_interpol + solar_rad_W_sqm_interpol +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
anova(CEWL_mod9p)

CEWL_mod12p <- lmerTest::lmer(data = dat_reduced,
                          # response variable
                          CEWL_g_m2h_mean ~ 
                          # blood
                          osmolality_mmol_kg_mean + 
                          # microclimate at the time of msmt
                          msmt_temp_C +
                          # time between capture and measurements
                          hold_time_hr +
                          (1|capture_date))
summary(CEWL_mod12p)

anova(CEWL_mod10p, type = "1", ddf = "Kenward-Roger")
anova(CEWL_mod9p, type = "1", ddf = "Kenward-Roger")
anova(CEWL_mod12p, type = "1", ddf = "Kenward-Roger")
```



## Group Model Export

```{r}
# model rankings
all_mod_ranks <- CEWL_AICc %>%
  rbind(osml_AICc) %>% 
  dplyr::rename(LL = Res.LL) %>%
  rbind(hct_AICc) %>%
  mutate(var = c(rep("CEWL", nrow(CEWL_AICc)), 
                 rep("osml", nrow(osml_AICc)), 
                 rep("hct", nrow(hct_AICc))),
         AICc = round(AICc, digits = 2),
         Delta_AICc = round(Delta_AICc, digits = 2),
         ModelLik = round(ModelLik, digits = 2),
         AICcWt = round(AICcWt, digits = 2),
         LL = round(LL, digits = 2),
         Cum.Wt = round(Cum.Wt, digits = 2))

# save
write.csv(all_mod_ranks, "./results_statistics/capture_ALL_mod_rankings.csv")

# calculate F & p-values
anova_tables <- data.frame(anova(CEWL_mod12p, 
                              type = "1", 
                              ddf = "Kenward-Roger")) %>%
  rbind(data.frame(anova(osml_mod8p, 
                              type = "1", 
                              ddf = "Kenward-Roger"))) %>%
  rbind(data.frame(anova(hct_mod7p) %>%
                     mutate(NumDF = 1, DenDF = 95) %>%
                     dplyr::select(-Df))) %>%
  mutate(df = paste((NumDF), round(DenDF, 0), sep = ", "),
         Sum.Sq = round(Sum.Sq, 0), 
         F.value = round(F.value, 2),
         term = rownames(.)) %>%
  dplyr::select(term, 
                seq_sum_of_squares = Sum.Sq, 
                df, 
                F_statistic = F.value, 
                p_value = Pr..F.) %>%
  dplyr::filter(term != "Residuals")

# rest of model results
all_top_mods <- broom.mixed::tidy(CEWL_mod12p) %>% # chose the least-variable one
  rbind(broom.mixed::tidy(osml_mod8p)) %>% # chose the least-variable one
  rbind((broom.mixed::tidy(hct_mod7p) %>%
           mutate(effect = NA,
                  group = NA,
                  df = NA))) %>%
  mutate(var = c(rep("CEWL", 6), 
                 rep("osml", 5), 
                 rep("hct", 3)),
         estimate = round(estimate, digits = 2),
         std.error = round(std.error, digits = 2)) %>%
  dplyr::select(var, effect, group, term, estimate, std.error) %>%
  left_join(anova_tables, by = 'term')

# save
write.csv(all_top_mods, "./results_statistics/capture_ALL_best_mods.csv")
```




# Figures



## Hct ~ SMI

```{r hct SMI fig}
ggplot(dat) + 
  aes(x = SMI,
      y = hematocrit_percent) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              color = "blue",
              alpha = 1) + 
  theme_classic() + 
  xlab("Body Condition (g)") + 
  ylab("Hematocrit (%)") + 
  #ylab("") +
  #xlim() +
  ylim(20,60) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_hct_SMI_fig
cap_hct_SMI_fig
```



## Hct ~ VPD at Capture

```{r hct VPD fig}
ggplot(dat) + 
  aes(x = VPD_kPa_int,
      y = hematocrit_percent,
      color = as.factor(capture_date)) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("VPD at Capture (kPa)") + 
  ylab("Hematocrit (%)") + 
  #ylab("") +
  #xlim() +
  ylim(20,60) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_hct_VPD_fig
cap_hct_VPD_fig
```



## Hct ~ Wind Speed at Capture

```{r hct wind fig}
ggplot(dat) + 
  aes(x = wind_mph_interpol,
      y = hematocrit_percent,
      color = as.factor(capture_date))+
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("Wind Speed at Capture (mph)") + 
  ylab("Hematocrit (%)") + 
  #ylab("") +
  #xlim() +
  ylim(20, 60) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_hct_wind_fig
cap_hct_wind_fig
```




## Hct ~ Solar Radiation at Capture

```{r hct sorad fig}
ggplot(dat) + 
  aes(x = solar_rad_W_sqm_interpol,
      y = hematocrit_percent,
      color = as.factor(capture_date)) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab(bquote('Solar Radiation (W/'*m^2*')')) + 
  ylab("Hematocrit (%)") + 
  #ylab("") +
  ylim(20, 60) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_hct_sorad_fig
cap_hct_sorad_fig
```


## Osmolality ~ SVL

```{r osml SVL fig}
ggplot(dat) + 
  aes(x = SVL_mm,
      y = osmolality_mmol_kg_mean) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1) + 
  theme_classic() + 
  xlab("Snout-Vent Length (mm)") + 
  ylab("Plasma Osmolality (mmol/kg)") + 
  #ylab("") +
  #xlim() +
  ylim(300,400) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_osml_SVL_fig
cap_osml_SVL_fig
```


## Osmolality ~ SMI

```{r osml SMI fig}
ggplot(dat) + 
  aes(x = SMI,
      y = osmolality_mmol_kg_mean) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1) + 
  theme_classic() + 
  xlab("Body Condition (g)") + 
  ylab("Plasma Osmolality (mmol/kg)") + 
  #ylab("") +
  #xlim() +
  ylim(300,400) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_osml_SMI_fig
cap_osml_SMI_fig
```


## Osmolality ~ VPD at Capture

```{r osml VPD fig}
ggplot(dat_reduced) + 
  aes(x = VPD_kPa_int,
      y = osmolality_mmol_kg_mean,
      color = as.factor(capture_date)
      ) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("VPD at Capture (kPa)") + 
  ylab("Plasma Osmolality (mmol/kg)") + 
  #ylab("") +
  #xlim() +
  ylim(300,400) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_osml_VPD_fig
cap_osml_VPD_fig
```


## Osmolality ~ Solar Radiation at Capture

```{r osml sorad fig}
ggplot(dat) + 
  aes(x = solar_rad_W_sqm_interpol,
      y = osmolality_mmol_kg_mean,
      color = as.factor(capture_date)) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab(bquote('Solar Radiation (W/'*m^2*')')) + 
  ylab("Plasma Osmolality (mmol/kg)") + 
  #ylab("") +
  ylim(300,400) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_osml_sorad_fig
cap_osml_sorad_fig
```


## Osmolality ~ Date

```{r osml date fig}
ggplot(dat) + 
  aes(x = as.factor(capture_date),
      y = osmolality_mmol_kg_mean,
      group = as.factor(capture_date)) +
  geom_boxplot() +
  geom_jitter(size = 1, 
              alpha = 0.4) + 
  theme_classic() + 
  xlab("Date") + 
  ylab("Plasma Osmolality (mmol/kg)") + 
  #ylab("") +
  #xlim() +
  ylim(300, 400) +
  #annotate("text", x = , y = , 
   #        label = "paste(italic(R) ^ 2, \" = 0.\")", 
    #       parse = TRUE,
     #      size = 6) +
  #annotate("text", x = , y = , 
   #        label = "paste(italic(p), \" < 0.0001\")", 
    #       parse = TRUE,
     #      size = 6) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_osml_date_fig
cap_osml_date_fig
```









## CEWL ~ Cloacal Temperature

```{r CEWL cloacal temp fig}
ggplot(dat) + 
  aes(x = cloacal_temp_C,
      y = CEWL_g_m2h_mean) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1) + 
  theme_classic() + 
  xlab("Cloacal Temperature (°C)") + 
  ylab(bquote('CEWL (g/'*m^2*'h)')) + 
  #ylab("") +
  #xlim() +
  ylim(0, 40) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_clotemp_fig
cap_CEWL_clotemp_fig
```


## CEWL ~ Plasma Osmolality

```{r CEWL osml fig}
ggplot(dat) + 
  aes(x = osmolality_mmol_kg_mean,
                 y = (CEWL_g_m2h_mean),
      #color = as.factor(capture_date)
      ) +
  geom_point(size = 1, 
             shape = 21,
             fill = "black",
             color = "black",
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              color = "black",
              size = 1, 
              alpha = 1) + 
  theme_classic() + 
  xlab(bquote('Osmolality (mmol '*kg^-1*')')) + 
  ylab(bquote('CEWL (g '*m^-2*' '*h^-1*')')) + 
  xlim(300, 400) +
  ylim(0, 40) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 8),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_osml_fig
cap_CEWL_osml_fig

ggsave(filename = "cap_CEWL_osml_fig.pdf",
       plot = cap_CEWL_osml_fig,
       path = "./results_figures",
       device = "pdf",
       dpi = 600,
       units = "mm",
       width = 80, height = 70)
```



### Add SLR

```{r}
CEWL_osml <- lm(data = dat, CEWL_g_m2h_mean ~ osmolality_mmol_kg_mean)
summary(CEWL_osml)
```





## CEWL ~ Temperature at Measurement

```{r CEWL temp fig}
ggplot(dat) + 
  aes(x = msmt_temp_C,
      y = CEWL_g_m2h_mean,
      color = as.factor(capture_date)) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1) + 
  theme_classic() + 
  xlab("Temperature at Measurement (°C)") + 
  ylab(bquote('CEWL (g/'*m^2*'h)')) + 
  #ylab("") +
  #xlim() +
  ylim(0, 40) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_temp_fig
cap_CEWL_temp_fig
```


## CEWL ~ VPD at Measurement

```{r CEWL VPD-m fig}
ggplot(dat) + 
  aes(x = msmt_VPD_kPa,
      y = CEWL_g_m2h_mean,
      color = as.factor(capture_date)) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("VPD at Measurement (kPa)") + 
  ylab(bquote('CEWL (g/'*m^2*'h)')) + 
  #ylab("") +
  #xlim() +
  ylim(0, 40) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_VPDm_fig
cap_CEWL_VPDm_fig
```




## CEWL ~ VPD at Capture

```{r CEWL VPD-c fig}
ggplot(dat) + 
  aes(x = VPD_kPa_int,
      y = CEWL_g_m2h_mean) +
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("VPD at Capture (kPa)") + 
  ylab(bquote('CEWL (g/'*m^2*'h)')) + 
  #ylab("") +
  #xlim() +
  ylim(0, 40) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_VPDc_fig
cap_CEWL_VPDc_fig
```


## CEWL ~ Wind at Capture

```{r CEWL wind fig}
ggplot(dat) + 
  aes(x = wind_mph_interpol,
      y = CEWL_g_m2h_mean)+
  geom_point(size = 1, 
             alpha = 0.4) + 
  stat_smooth(formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("Wind Speed at Capture (mph)") + 
  ylab(bquote('CEWL (g/'*m^2*'h)')) + 
  #ylab("") +
  #xlim() +
  ylim(0, 40) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_wind_fig
cap_CEWL_wind_fig
```


## CEWL ~ Date

```{r CEWL date fig}
ggplot(dat) + 
  aes(x = as.factor(capture_date),
      y = CEWL_g_m2h_mean,
      group = as.factor(capture_date)) +
  geom_boxplot() +
  geom_jitter(size = 1, 
              alpha = 0.4) + 
  theme_classic() + 
  xlab("Date") + 
  ylab(bquote('CEWL (g/'*m^2*'h)')) + 
  #ylab("") +
  #xlim() +
  ylim(0, 40) +
  #annotate("text", x = , y = , 
   #        label = "paste(italic(R) ^ 2, \" = 0.\")", 
    #       parse = TRUE,
     #      size = 6) +
  #annotate("text", x = , y = , 
   #        label = "paste(italic(p), \" < 0.0001\")", 
    #       parse = TRUE,
     #      size = 6) +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 22),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 16),
        #axis.text.y = element_blank(),
        #plot.margin = unit(c(0.1,0,0.1,0.45), "cm")
        ) -> cap_CEWL_date_fig
cap_CEWL_date_fig
```










